language: python

variables:
  PYPI_USER: SECURE
  PYPI_PASS: SECURE
  TEST: SECURE

matrix:
 include:
  - os: linux
    python: 3.6

stages:
 - install
 - test
 - deploy

install:
 - pip install -r requirements-dev.txt

script:
 - coverage erase
 - coverage run -a --source ./sksurgerycalibration -m pytest -v -s ./tests/
 - coverage report -m
 - pylint --rcfile=tests/pylintrc sksurgerycalibration tests
 - echo $TEST

after_success:
 - coveralls

deploy:
  provider: pypi
  user: $PYPI_USER
  password: $PYPI_PASS
  on:
   tags: true
   branch: 7-pypi
